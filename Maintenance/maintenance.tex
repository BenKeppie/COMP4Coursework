\chapter{System Maintenance}

\section{Environment}

\subsection{Software}

During the implementation of my program I used a variety of software items to help me create the program for my client. The software I used is detailed in the bullet points below.

\begin{itemize}
\item Python 3.4
\item IDLE (python GUI)
\item PyQt 4
\item SQLite3
\item smtplib
\item pdb
\item SQLite Inspector
\item Notepad ++ v6.6.7
\item Google Chrome
\end{itemize}

\subsection{Usage Explanation}

The table below gives details of why I decided to use the software I used. 

\begin{center}
\begin{tabular}{|p{3.5cm}|p{8cm}|} \hline
\textbf{Software} & \textbf{Justification for Use} \\ \hline
Python 3.4 & Python is the programming language I am most confident with as I have been learning it through the past two years at college. Python is also the most supported program at my college. \\ \hline
IDLE (python GUI) & This programming editor comes with the free installation of Pyton, and is the only programming environment available at my college. \\ \hline
PyQt 4 & This software is an add on to the python programming language which allowed for me to create a graphical user interface for my program. \\ \hline
SQLite 3 & This software came along with the Python 3.4 library and I also had some previous experience of using it, therefore I used it to handle my SQL queries. \\ \hline
smtplib & This module came along with the Python 3.4 library and allowed me to send emails to me (the developer) about any bugs in the program. \\ \hline
pdb & This module came along with the python 3.4 library and was readily available to be imported \\ \hline
SQLite Inspector & This piece of software allowed me to look inside my database and test SQL queries. This was available for me to use at college and home as my teacher created it. \\ \hline
Notepad ++ v6.6.7 & This piece of software allowed me to test my JavaScript code and allowed me to debug any formatting errors as JavaScript isn't formatted nicely in IDLE. \\ \hline
Google Chrome & I am familiar with using this web browser and it also has plenty of compatibility with lots of programming languages therefore I used this to view my Javascript script. \\ \hline

\end{tabular}
\label{tab:Software Justification}
\end{center}


Another reason for using all the programs I have used is the fact that they are free to download from the internet, which therefore creates a free application for my client to use.

\subsection{Features Used}

\begin{center}
\begin{tabular}{|p{3.5cm}|p{8cm}|} \hline
\textbf{Software} & \textbf{Features Used} \\ \hline
Python 3.4 & I used python to run my program which allowed me to test the graphical user interface of my program. I also used the code libraries which came with the installation of Python to code my system.  \\ \hline
IDLE (python GUI) & I used IDLE to write out my code and save it as a python file. I took advantage of the colour coded syntax and also the code predictor. I also used IDLE to run the python file.\\ \hline
PyQt 4 & I used PyQT extensively, from using pre-programmed classes such as QVBoxLayout to rewriting some classes such as the QWebPage class. PyQT was used to create the graphical user interface of my program.\\ \hline
SQLite 3 & I used this piece of software to write SQL queries that would allow me to add,edit, delete and retrieve data from my database and ensure referential integrity was enforced. \\ \hline
smtplib & I used the email sending capabilities of this module. \\ \hline
pbd & I used this module as an interactive debugger to help debug my code \\ \hline
SQLite Inspector & I used SQLite inspector for two functions. First of all I used it to check that data had been added/edited/deleted properly. Secondly I used it to check that my SQL statements were correct. \\ \hline
Notepad ++ v6.6.7 & I used this piece of software to debug and write the Javascript for my google maps integration found in the 'skatepark' tab of my program. \\ \hline
Google Chrome & I used Google Chrome to check that my Javascript code functioned properly inside a web browser. I also took advantage of the 'developer' features of google chrome to debug my Javascript.\\ \hline

\end{tabular}
\label{tab:Software Features Used}
\end{center}

\section{System Overview}

\subsection{General User Interface}

On every part of my user interface a QMenuBar is at the top, allowing you to access functionality of any tab from anywhere in the program, for example if you are on the profile tab you can click on the 'support' part of the QMenuBar and click 'contact support' on the drop down options and the view of the program will change to the support tab and load the correct widgets to allow for the user to contact support. A QStatusBar is also available on every page which displays messages at appropriate times, informing the user about changes that have occurred.

\subsection{Profile Tab User Interface}

The profile tab consists of a QToolBar at the top of the tab labeled 'Change Picture' widget allowing you to change your profile picture which is displayed in a QGraphicsScene. Below the profile picture there are 2 QPushButtons labelled 'Edit' and 'Save'. To the right of this there are three QLineEdits showing the users first name, last name and email address, to the right of these QLineEdits is a Recently completed tricks list. Below the tabbed interface a QProgressBar which shows the percentage of completed tricks.

\subsection{Editing Profile Table Information}
Once the edit button is clicked the QLineEdits containing the first name, last name and email address of the user become available to edit. Once the QLineEdits have been changed you may click the 'save' button to save the changes.Once the 'Change Picture' button is pressed a QFileDialog appears allowing you to choose an image from your documents to set as your profile picture.



\subsection{Tricks Tab User Interface}

The tricks tab also contains the QProgressBar below the tabbed interface. There is also a QToolBar with an option to add a trick. Below the QToolBar a QTableView displays all of the items in the tricks table of the database. Once the 'Add Trick' button is pressed a side form appears on the left hand side with QLineEdits, QPushButtons and QComboBoxes which allow you to fill in information about a trick.

\subsection{Editing Trick Table Information}

Once the 'Add Trick' button has been pressed you can fill in information about a trick, once the 'save' button below the form has been pressed the trick will be saved to the database if all the fields are valid. If a field is invalid then the invalid fields will be highlighted red. To delete a trick you select the row you wish to delete and then press the delete key, a confirmation message will appear and you click the 'save' button to accept the delete. To edit a trick you have to run through the CLI menu and then run through the appropriate steps.



\subsection{Skateparks Tab User Interface}

The Skateparks tab interface is similar to that of the Tricks tab, but the table is replaced with a QWebView of the Google map.

\subsection{Editing Skatepark Table Information}

To add a skatepark you click on the Google Maps object, the program will then automatically fill in the latitude and longitude of the marker. Then you need to fill in the skatepark name and description. Then click save to save the skatepark to the database. To edit or delete a skatepark you have to run through the CLI menu and run through the appropriate steps



\subsection{Reviews Tab User Interface}

The Review user interface is similar to the tricks tab. But the table is replaced with information about reviews.

\subsection{Editing Review Table Information}

To edit the review table you have to run through the CLI menu and run thorugh the appropriate steps.



\subsection{Support Tab User Interface}

The support tab consists of a QLabel containing my details as the application developer and a series of QLineEdits allowing the user to enter information to send a bug. A 'submit' QPushButton is below this form.

\subsection{Reporting a Bug}

A series of QLineEdits must be filled in, in order to send a message about a bug in the program. This includes: Users name and email address, as well as the actual message saying what the bug is. 










\section{Code Structure}

My general code was structured around a graphical user interface where I have incorporated PyQt functions and object orientated programming concepts which I have developed over the past two years of learning python. A sample of coding structures are shown below.


\subsection{Main Window}

\subsection{Tabs}

\subsection{Menu Bar}

\subsection{Tool Bar}

\subsection{SQL Connections}

\subsection{Validation}











\section{Variable Listing}

My data dictionary can be found on Figure \ref{tab:Data Dictionary} on page \pageref{tab:Data Dictionary}. My other variables that I implemented in my program can be found in the table below.

\begin{center}
\begin{longtable}{|p{3.5cm}|p{6cm}|p{3.5cm}|} \hline
\textbf{Variable} & \textbf{Purpose} & \textbf{Reference} \\ \hline
splash\_pix & Stores a QPixmap image of the programs splash screen. & Subsection 4.10.1, line number 115 \\ \hline
replace & A string to replace another variables string & Subsection 4.10.3, line numbers: 78,79,80. Subsection 4.10.6, line numbers: 35,36,37. Subsection 4.10.8, line numbers: 302,303 \\ \hline
FirstName & A variable to temporarily hold the first name of the user & Subsection 4.10.7, line numbers:17,19,22. \\ \hline
LastName & A variable to temporarily hold the last name of the user & Subsection 4.10.7, line numbers: 18,19,22. \\ \hline
Email & A variable to temporarily hold the email address of the user & Subsection 4.10.7, line numbers: 32,36. \\ \hline
cursor & a variable to act as the database cursor & subsection 4.10.7, line numbers: 24, 38, 52, 61, 68, 74. \\ \hline
self.RedBorder & A style sheet used to give a QWidget a red border & Subsection 4.10.8, line numbers: 15, 133, 146, 157. \\ \hline
self.GreenBorder & A style sheet used to give a QWidget a green border & Subsection 4.10.8, line numbers: 16, 130, 143, 154. \\ \hline
query & holds a QSqlQuery object & Subsection 4.10.8, line numbers: 94, 95, 116. \\ \hline
Text & Holds the text of a QLineEdit whilst the data entry is being validated &Subsection 4.10.8, line numbers: 126, 128, 139, 141, 150, 152. Subsection 4.10.11, line numbers: 62, 64, 72, 73, 82, 83. \\ \hline
TrickNameExpression & Holds the compiled regular expression for the trick name & Subsection 4.10.8, line numbers:127, 128. \\ \hline
TrickDescriptionExpression & Holds the compiled regular expression for the trick description & Subsection 4.10.8, line numbers: 140, 141 \\ \hline
TrickObsticleExpression & Holds the compiled regular expression for the trick obsticle &Subsection 4.10.8, line numbers: 151, 152. \\ \hline
TrickTutorialExpression & Holds the compiled regular expression for the trick tutorial link & Subsection 4.10.8, line numbers: 162, 163. \\ \hline
SkateparkNameExpression & Holds the compiled regular expression for the skatepark name& Subsection 4.10.11, line numbers: 63, 64. \\ \hline
SkateparkDescriptionExpression & Holds the compiled regular expression for the skatepark description & Subsection 4.10.11, line numbers: 52 ,53. \\ \hline
Match & Matches the Text of a QLineEdit against the appropriate regular expression & Subsection 4.10.8, line numbers: 128, 141, 152, 163. Subsection 4.10.11, line numbers: 53, 54, 64, 65. \\ \hline
sql & holds the sql text for sqlite3 queries & Subsection 4.10.10, line numbers: 15, 43. Subsection 4.10.12, line numbers: 78. Subsection 4.10.14, line numbers: 13. \\ \hline
self.LastMarker & Holds the coordinates of the last marker placed on the google map & Subsection 4.10.12, line numbers: 55, 57. \\ \hline
self.html & Holds all of the HTML/Javascript for my google maps object & Subsection 4.10.12, line number: 100. \\ \hline
var markers & A Javascript list for holding the markers coordinates & Subsection 4.10.12, line numbers: 118, 164, 187, 188, 195. \\ \hline
var ContentString & A Javascript variable for holding the text description for each marker & Subsection 4.10.12, line number 166. \\ \hline
Send & A variable to compile the SMTP protocol for sending an email & Subsection 4.10.18, line numbers: 32, 33, 34.  \\ \hline
msg & A variable to format the email to send & Subsection 4.10.18, line numbers: 26, 27, 28, 29, 30. \\ \hline
result & Stores the result of an sqlite3 query & \\ \hline
db\_name & The name of the programs database & \\ \hline 
Choice & Stores the users choice whilst navigation the CLI & \\ \hline 
Finished & A while loop condition that changes to True once the conditions are satisfied & \\ \hline



\end{longtable}
\label{tab:Variable List}
\end{center}






\section{System Evidence}

\subsection{User Interface}

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/ChangePicture.pdf}
    \caption{User interface, changing profile picture} \label{fig:Changing Picture UI}
\end{figure}


\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/TricksTab.pdf}
    \caption{User interface, switching to the tricks tab} \label{fig:Trick Tab UI}
\end{figure}


\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/AddTrick.pdf}
    \caption{User interface, adding a trick} \label{fig:Add Trick UI}
\end{figure}


\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/SkateparkTab.pdf}
    \caption{User interface, switching to the skateparks tab} \label{fig:Skatepark Tab UI}
\end{figure}


\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/AddSkatepark.pdf}
    \caption{User interface, adding a skatepark} \label{fig:Add Skatepark UI}
\end{figure}


\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/ReviewTab.pdf}
    \caption{User interface, switching to the reviews tab} \label{fig:Review Tab UI}
\end{figure}


\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/AddReview.pdf}
    \caption{User interface, adding a review} \label{fig:Add Review UI}
\end{figure}


\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/SupportTab.pdf}
    \caption{User interface, switching to the support tab} \label{fig:Support Tab UI}
\end{figure}











\subsection{ER Diagram}

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Design/EntityRelationships2.pdf}
    \caption{Entity-Relationship Diagram} \label{fig:Entity Diagram}
\end{figure}







\subsection{Database Table Views}

The figures below show all the entities and tables that I used in the creation of my program so far.

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/UserTable.jpg}
    \caption{The user table of the database} \label{fig:User Table}
\end{figure}

The screen shot above shows the user table which contains information about the user.

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/TrickTable.jpg}
    \caption{The trick table of the database} \label{fig:Trick Table}
\end{figure}

The screen shot above shows the tricks table which contains information about multiple tricks.


\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/SkateparkTable.jpg}
    \caption{The skatepark table of the database} \label{fig:Skatepark Table}
\end{figure}

The screen shot above shows the skatepark table which contains information about multiple skateparks.

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/ReviewTable.jpg}
    \caption{The review table of the database} \label{fig:Review Table}
\end{figure}

The screen shot above shows the review table which contains information about multiple reviews.

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/ProductBrandTable.jpg}
    \caption{The product brand table of the database} \label{fig:ProductBrand Table}
\end{figure}

The screen shot above shows the product brand table which contains information about different product brands which you can review.

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/ProductSizeTable.jpg}
    \caption{The product size table of the database} \label{fig:ProductSize Table}
\end{figure}

The screen shot above shows the product size table which contains information about different product sizes which you can review.

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/ProductTypeTable.jpg}
    \caption{The product type table of the database} \label{fig:ProductType Table}
\end{figure}

The screen shot above shows the product type table which contains information about different product types which you can review.

\textbf{Unused Database Table Views}

The figures below show the tables that I will use in the future to implement a multi-user system. However, currently the program is a single user system and therefore they do not have any data inside the tables.

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/UserTrickTable.jpg}
    \caption{The user trick table of the database} \label{fig:UserTrick Table}
\end{figure}

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/UserSkateparkTable.jpg}
    \caption{The user skatepark table of the database} \label{fig:UserSkatepark Table}
\end{figure}

\begin{figure}[H]
    \includegraphics[width=\textwidth]{./Maintenance/Figures/UserReviewTable.jpg}
    \caption{The user review table of the database} \label{fig:UserReview Table}
\end{figure}


\subsection{Database SQL}

To create the entities I used the following SQL code:

\pythonfile[firstline=28, lastline=105]{./Implementation/CLI/database.py}

To see the full code please look at Subsection 4.10.22.

\subsection{SQL Queries}

\subsubsection{Change Name SQL Query}

\pythonfile[firstline=16,Lastline=27]{./Implementation/profile_sql_connections.py}
\section{Testing}

\subsubsection{Change Email SQL Query}
\pythonfile[firstline=31,Lastline=41]{./Implementation/profile_sql_connections.py}

\subsubsection{Change Picture SQL Query}
\pythonfile[firstline=45,Lastline=54]{./Implementation/profile_sql_connections.py}

\subsubsection{Select First Name SQL Query}
\pythonfile[firstline=59,Lastline=65]{./Implementation/profile_sql_connections.py}

\subsubsection{Select Last Name SQL Query}
\pythonfile[firstline=66,Lastline=71]{./Implementation/profile_sql_connections.py}



\subsubsection{Delete Trick Row SQL Query}
\pythonfile[firstline=11,Lastline=17]{./Implementation/tricks\_sql\_connections.py}


\subsubsection{Select All Tricks From the Trick Table SQL Query}
\pythonfile[firstline=31,Lastline=35]{./Implementation/tricks\_sql\_connections.py}

\subsubsection{Add Trick to Database SQL Query}
\pythonfile[firstline=37,Lastline=48]{./Implementation/tricks\_sql\_connections.py}



\subsubsection{Add Skatepark to Database SQL Query}
\pythonfile[firstline=9,Lastline=18]{./Implementation/skateparks\_sql\_connections.py}



\subsubsection{Select all Reviews Fom the Reviews Table SQL Query}
\pythonfile[firstline=21,Lastline=25]{./Implementation/reviews\_sql\_connections.py}



\section {Testing}

To view my full test plan look at Figure \ref{tab:Testing} on page \pageref{tab:Testing}

\subsection{Summary of Results}

My testing showed that my program was not a fully GUI operated program. It also identified key, minor issues with validation which I will fix then the next version in my program.

\subsection{Known Issues}

There are a few known issues with my system. These are outlined below.

\subsubsection{Flashing Tables on Start-Up}

When starting up my program, the QSqlTableView objects load individually before loading the whole program (trick and review table). This doesn't cause a problem with the functionality of the program; however the start-up time is increased. Through interactive debugging using the pdb debugger I managed to find that the problem occurs when the model is set; however I do not know how to resolve this issue. I have attempted to move around the order of setting layouts as the problem would appear to be a problem in the order of setting the layout. However, doing this did not resolve the issue.

\subsubsection{Validation}

The validation involved with all of the file paths is not present in the code and the validation involved with the QLineEdit's on the profile tab are also not present. These would be fixed by a simple validation method similar to that of the 'add trick' and 'add skatepark' validation lines.

\subsubsection{Incomplete GUI}

My GUI is incomplete for my program as the review tabs functionality is not present. This would be fixed by an extended period of time for working on my program.









\section{Code Explanations}

\subsection{Difficult Sections}

\subsection{Self-created Algorithms}













\section{Settings}

No settings need to be changed on the client's computer to run my program. All of the neccesary modules required are supplied with python, PyQt and my public API key is used to run the google maps object.





\section{Acknowledgements}

\begin{itemize}
\item Acknowledgment 1 - YouTube link regular expression - Found on \url{http://stackoverflow.com/questions/3717115/regular-expression-for-youtube-links} by Stack Overflow user \url{http://stackoverflow.com/users/3652125/fanmade}
\item Acknowledgment 2 - Google Maps JavaScript API - Gained from Google's APIs Console. - \url{https://developers.google.com/maps/documentation/javascript/tutorial}
\item Acknowledgment 3 - Javascript help on Stack Overflow - \url{http://stackoverflow.com/questions/28253168/running-a-javascript-function-from-qwebview-google-maps-api-pyqt} I posted a question to attempt to resolve an issue I had with my Javascript code.
\end{itemize}

\section{Code Listing}

\subsection{Main Window}

\pythonfile[firstline=1]{./Implementation/main_window.pyw}

\subsection{Main Tabbed Widget}

\pythonfile[firstline=1]{./Implementation/main_tab_widget.py}

\subsection{Menu Bar}

\pythonfile[firstline=1]{./Implementation/menu_bar.py}



\subsection{Profile Widget}

\pythonfile[firstline=1]{./Implementation/profile_widget.py}

\subsection{Profile Picture}

\pythonfile[firstline=1]{./Implementation/profile_picture.py}

\subsection{Profile Toolbar}

\pythonfile[firstline=1]{./Implementation/profile_toolbar.py}

\subsection{Profile SQL Connections}

\pythonfile[firstline=1]{./Implementation/profile_sql_connections.py}



\subsection{Tricks Widget}

\pythonfile[firstline=1]{./Implementation/tricks_widget.py}

\subsection{Tricks Toolbar}

\pythonfile[firstline=1]{./Implementation/tricks_toolbar.py}

\subsection{Tricks SQL Connections}

\pythonfile[firstline=1]{./Implementation/tricks_sql_connections.py}



\subsection{Skateparks Widget}

\pythonfile[firstline=1]{./Implementation/skateparks_widget.py}

\subsection{Skateparks Map}

\pythonfile[firstline=1]{./Implementation/skatepark_view_only.py}

\subsection{Skateparks Toolbar}

\pythonfile[firstline=1]{./Implementation/skateparks_toolbar.py}

\subsection{Skateparks SQL Connections}

\pythonfile[firstline=1]{./Implementation/skateparks_sql_connections.py}



\subsection{Reviews Widget}

\pythonfile[firstline=1]{./Implementation/reviews_widget.py}

\subsection{Reviews Toolbar}

\pythonfile[firstline=1]{./Implementation/reviews_toolbar.py}

\subsection{Reviews SQL Connections}

\pythonfile[firstline=1]{./Implementation/reviews_sql_connections.py}



\subsection{Support Widget}

\pythonfile[firstline=1]{./Implementation/support_widget.py}



\subsection{CLI Menu}

\pythonfile[firstline=1]{./Implementation/CLI/menu.py}

\subsection{CLI Get Menu Option}

\pythonfile[firstline=1]{./Implementation/CLI/get_menu_option.py}

\subsection{CLI Database Table Menu}

\pythonfile[firstline=1]{./Implementation/CLI/database_table_menu.py}

\subsection{CLI Create Database}

\pythonfile[firstline=1]{./Implementation/CLI/database.py}

\subsection{CLI Profile Edit Options}

\pythonfile[firstline=1]{./Implementation/CLI/profile_edit_options.py}

\subsection{CLI Trick Edit Options}

\pythonfile[firstline=1]{./Implementation/CLI/trick_edit_options.py}

\subsection{CLI Skatepark Edit Options}

\pythonfile[firstline=1]{./Implementation/CLI/skatepark_edit_options.py}

\subsection{CLI Review Edit Options}

\pythonfile[firstline=1]{./Implementation/CLI/review_edit_options.py}

\subsection{CLI Make New Difficulty}

\pythonfile[firstline=1]{./Implementation/CLI/difficulty.py}

\subsection{CLI Make New Product}

\pythonfile[firstline=1]{./Implementation/CLI/products.py}




